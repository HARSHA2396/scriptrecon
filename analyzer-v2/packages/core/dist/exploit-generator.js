import path from 'path';
export function generatePoC(sinkType, fileName, line, variableName) {
    let pocString = '';
    let description = '';
    switch (sinkType) {
        case 'XSS':
            description = 'Reflected Cross-Site Scripting (XSS) via `eval()` or `innerHTML`.';
            pocString = `<script>alert(document.cookie);</script>\n`;
            pocString += `// If this sink is accessible via URL, try:\n`;
            pocString += `// ?${variableName}=%3Cscript%3Ealert(document.cookie)%3C%2Fscript%3E`;
            break;
        case 'COMMAND_INJECTION':
            description = 'OS Command Injection via `child_process.exec()`.';
            pocString = `// Payload to test blind OS execution:\n`;
            pocString += `"; ping -c 4 127.0.0.1; #"\n`;
            pocString += `// If injecting into an API endpoint:\n`;
            pocString += `curl -X POST http://localhost:3000/api -H "Content-Type: application/json" -d '{"${variableName}": "; whoami > /tmp/hacked #"}'`;
            break;
        case 'SQL_INJECTION':
            description = 'SQL Injection via unparameterized database query.';
            pocString = `' OR 1=1 --\n`;
            pocString += `// Time-based blind execution test:\n`;
            pocString += `'; SELECT pg_sleep(10); --`;
            break;
        case 'PROTOTYPE_POLLUTION':
            description = 'Prototype Pollution via `Object.assign()` or Spread Operator.';
            pocString = `// Send malicious JSON payload to target endpoint:\n`;
            pocString += `curl -X POST http://localhost:3000/api -H "Content-Type: application/json" -d '{"__proto__": {"isAdmin": true}}'`;
            break;
        default:
            description = 'Generic vulnerability sink.';
            pocString = `// Inspect the data flow to variable '${variableName}' in file ${path.basename(fileName)} at line ${line}.`;
            break;
    }
    return {
        sinkType,
        description,
        pocString
    };
}
